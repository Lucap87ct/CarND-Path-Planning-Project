
# Path Planning Project
Self-Driving Car Engineer Nanodegree Program

![](record.gif)

The Project
---

In this project a path planning algorithm is implemented to make a vehicle safely navigate in a virtual highway with other vehicles using the original simulator provided by Udacity.

The path planning is designed in order to comply to the following requirements:
* Drive on the carriageway (one of the three lanes available)
* Drive at a speed as high as possible but below the speed limit (50 mph)
* Keep the center of the current lane
* Detect vehicles in the same lane and ahead within 30m that are slower than the host vehicle
* Adjust speed according to vehicles ahead in the same lane
* Detect which lane is free, i.e. it is on the same carriageway, it is not occupied by a vehicle ahead within 30m, nor by a vehicle in the rear within 30m, nor by a fast vehicle (10mph faster or more than host vehicle) in the rear between 30 and 50m
- Perform lane change into a free lane when there is a slower vehicle ahead
* The above resulting in avoiding any collision with other vehicles
* Execute smooth trajectories in terms of acceleration (lateral and longitudinal) and jerk

Code guidelines
---

The code of the path planning is located inside src/main.cpp from line 98 to line 350. It was decided to keep it simple and compact because the algorithm is very basic.
The code is commented in order to make it easy to navigate through it.

An improvement could be using object oriented programming, creating a class for the path planning algorithm., especially if the path planning algorithm becomes more complex.

* In lines 98 to 130 some constants and parameters are defined for the path planning algorithm
* From line 131 to 162 the current host vehicle lane is calculated and the basic overtaking rules are defined to make sure the vehicle stays on the carriageway
* In lines 163 to 215 the data from object fusion are used to determine if there is a close vehicle ahead, extracting its velocity, and if there are vehicles occupying the neighbor lanes
* In lines 216 to 240 the logic for regulating speed and deciding reference lane is implemented
* From lines 241 to 350 the trajectory planning is implemented using the open source spline library, interpolating between waypoints taken both from the points of previous host vehicle path and new points based on reference lane. Finally from the spline the actual planning points are generated by sampling the spline taking into account reference velocity
* The rest of the code was already provided and consists of the communication part with the simulator and some helper functions

Reflection
---

The vehicle is able to drive autonomously for several miles without issues (> 5 miles generally).

The following two issues were sporadically observed but so far they are not easily reproduceable:
* Collision with vehicle coming from behind at fast speed. Root cause could be the fact that some vehicles come very fast from behind and outside of the distance check and cannot decelerate in time before the host vehicle
* Unstable lane changing behavior resulting in too long time spent on top of the lane line

The countermeasure to check faster vehicles from behind within a larger safe distance was introduced. The drawback would be less lane changes but safety is preferred.

In general with low traffic the vehicle drives smoothly and changes lane when a slower vehicle is ahead.
When there is heavy traffic, lane changes occur less frequently and the vehicle might drive longer behind a slower vehicle.
